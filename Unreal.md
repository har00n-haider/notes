# Contents

- [Contents](#contents)
- [General](#general)
    - [Where to put logic?](#where-to-put-logic)
    - [Collision](#collision)
    - [Generated folders](#generated-folders)
    - [Build issues](#build-issues)
- [Loading assets](#loading-assets)
- [Garbage collection](#garbage-collection)
  - [Key points](#key-points)
  - [Refs](#refs)
- [Working in C++](#working-in-c)
  - [General tips](#general-tips)
  - [Using pointers](#using-pointers)
  - [Exposing C++ to blueprints](#exposing-c-to-blueprints)
    - [General tips](#general-tips-1)
  - [Working asynch in UE4](#working-asynch-in-ue4)
    - [Does everything that is blueprints visible have to be a UCLASS()](#does-everything-that-is-blueprints-visible-have-to-be-a-uclass)
- [Resources](#resources)

# General

### Where to put logic?

There a number of places where you could put game logic, but there are some guidelines on where best to put stuff.

1. PlayerController. Anything to do with how input will be 
2. Pawn: This is the manifestation of the player in the Unreal world. Things like setting up meshes, animation, etc. is best to do here
3. 

In simple cases the distinction between PlayerController/Pawn is not so deep so its fine to . Its still worth trying to keep behaviour seperate from the the manifestation logic.

### Collision

Blocking collisions only happen when both entities are mutually blocking each other. e.g. 

| moving     | B | B | I | I |
|------------|---|---|---|---|
| stationary | I | B | I | B |
| can pass?  | Y | N | Y | Y |

### Generated folders

These folders are generated by UE when compiling and running a game project. They are not commited to source control. Some compile/intellisense issues can be solved by deleting and regenerating these folders.


- Binaries
- Build
- DerivedDataCache
- Intermediate
- Saved

Sometimes the VS project itself and its ".vs" settings folder could also cause issues, so deleting them and regenerating the vs project file can help with issues (e.g. when new code files are added etc.)

More info here: https://docs.unrealengine.com/en-US/Basics/DirectoryStructure/index.html

### Build issues 

Error message:

> Could not be compiled. Try rebuilding from source manually.

- This message usually arises when there is C++ code associated with the project that cannot be compiled. 
- Can also happen because there are modules associated with the file that used to have code, but were removed from the project. You can solve this by manually removed the offending modules from the uproject files:
Could not be compiled. Try rebuilding from source manually:
```
{
	"FileVersion": 3,
	"EngineAssociation": "4.25",
	"Category": "",
	"Description": "",

        // This module was causing the issue (probably because I added C++ code
        // there at some point but deleted it after.
	"Modules": [
		{
			"Name": "ThirdPersonProject",
			"Type": "Runtime",
			"LoadingPhase": "Default"
		}
	]
}
```


# Loading assets


There seem to be a number of ways to load assets from the contents folder in C++:

1. Using the UAssetManager with the GetAssetDataForPath function
2. Using the UKismetSystemLibrary::LoadAsset_Blocking (or asynchronous)
3. Using ConstructorHelpers::FObjectFinder<T> after checking the Succeeded() flag
4. Using LoadObject<T>()


# Garbage collection

## Key points

- Only those classes that inherit from UObject will be considered for GC. All other classes need to do deal with their own memory management (e.g using smart pointers)
- UObjects can be added to a rootset in orded to protect them from the GC.

## Refs

- https://docs.unrealengine.com/4.26/en-US/ProgrammingAndScripting/ProgrammingWithCPP/IntroductionToCPP/
- https://docs.unrealengine.com/4.26/en-US/ProgrammingAndScripting/ProgrammingWithCPP/UnrealArchitecture/Objects/Optimizations/#garbagecollection
- https://www.ue4community.wiki/memory-management-6rlf3v4i


# Working in C++

## General tips
- If you can't figure out how to do something in C++, make the blueprints version, then convert to native and see how what classes are usefull!


## Using pointers

- You cannot make a TSharedRef pointer to a UObject, doing so will result in an error
```
Severity	Code	Description	Project	File	Line	Suppression State
Error	C2665	'URepo3d::operator new': none of the 2 overloads could convert all the argument types	repounreal	F:\Program Files\Epic Games\UE_4.26\Engine\Source\Runtime\Core\Public\Templates\SharedPointerInternals.h	135	
```
- TSharedRef pointers need a default constructor on the object they are pointing to 

## Exposing C++ to blueprints

https://docs.unrealengine.com/4.27/en-US/ProgrammingAndScripting/Blueprints/TechnicalGuide/ExtendingBlueprints/
 
### General tips
- UCLASS(Blueprintable) is inhereted from parent classes so can be skipped if inheriting from blueprintable class

## Working asynch in UE4

https://conoscerelinux.org/wp-content/uploads/2019/11/Mischitelli-Slides-Nov2019.pdf

### Does everything that is blueprints visible have to be a UCLASS()

In order for 


# Resources

General resources to complement the standard unreal docs

https://unrealcommunity.wiki/
https://www.tomlooman.com



